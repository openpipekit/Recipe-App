window.App={Models:{},Collections:{},Views:{},Routers:{},init:function(){"use strict";console.log("Hello from Backbone!");new App.Routers.Main;Backbone.history.start()},host:"http://dev-mad-lib-robots.pantheon.io/"},$(document).ready(function(){"use strict";var a=Backbone.sync;Backbone.sync=function(b,c,d){return d||(d={}),d.crossDomain||(d.crossDomain=!0),a(b,c,d)},App.init()}),this.JST=this.JST||{},this.JST["app/scripts/templates/recipe.ejs"]=function(obj){obj||(obj={});{var __t,__p="";_.escape}with(obj)__p+="<h1>"+(null==(__t=title)?"":__t)+'</h1>\n\n<p class="lead statement">\n  '+(null==(__t=statement)?"":__t)+'\n</p>\n\n<div class="recipe">\n  <div class="form-group">\n    <textarea class="form-control" rows="3" id="recipe" readonly>'+(null==(__t=code)?"":__t)+'</textarea>\n  </div>\n  <h3> Read Me </h3>\n  <blockquote class="install-instructions">\n    <p> '+(null==(__t=readme)?"":__t)+" </p>\n  </blockquote>\n\n</div>\n";return __p},App.Models=App.Models||{},function(){"use strict";App.Models.Recipe=Backbone.Model.extend({id:"nid",url:function(){return App.host+"/node/"+this.id+".json"},initialize:function(){},defaults:{authorId:"",statement:"",recipe:"",readme:"",tags:""},validate:function(a,b){},parse:function(a,b){var c=JSON.parse(a);return _.isArray(c.field_statement)&&(c.field_statement=c.field_statement.join("\n")),_.isArray(c.field_code)&&(c.field_code=c.field_code.join("\n")),_.isArray(c.field_readme)&&(c.field_readme=c.field_readme.join("\n")),c.statement=c.field_statement,c.code=c.field_code,c.readme=c.field_readme,c},getIngredients:function(){var a=[],b=this.get("recipe").match(/{{(.*?)}}/g);return b.forEach(function(b){b=b.substr(2,b.length),b=b.substr(0,b.length-2),a.push(b)}),a}})}(),App.Views=App.Views||{},function(){"use strict";App.Views.Recipe=Backbone.View.extend({template:JST["app/scripts/templates/recipe.ejs"],tagName:"form",className:"recipe",events:{"click button":"bake",keyup:"bake"},initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){this.model.on("sync",function(){var a=this.model.toJSON();a.statement=this.getHtmlStatement(),this.$el.html(this.template(a)),autosize(this.$el.find("textarea")),this.$el.find(".input").each(function(){$(this).css("min-width",$(this).width()+"px"),$(this).one("click",function(){$(this).text("")})})},this),this.model.fetch({dataType:"text"})},getHtmlStatement:function(){var a="",b=this.model.get("statement").split(" ");return b.forEach(function(b){if("{{"==b.substr(0,2)){var c=b.substr(2,b.length);c=c.substr(0,c.length-2),a+='<span style="display: inline-block; padding: 5px;border: 1px solid #ccc; border-radius: 4px;" class="input" data-name="'+c+'" contentEditable=true> '+b+"</span> "}else a+=b+" "}),a},bake:function(){console.log("Baking.");var a={};this.$el.find(".input").each(function(b){a[$(this).attr("data-name")]=$(this).text()}),$("textarea").text(Mustache.render(this.model.get("code"),a))}})}(),App.Routers=App.Routers||{},function(){"use strict";App.Routers.Main=Backbone.Router.extend({routes:{"recipe/:id":"recipe",add:"add"},recipe:function(a){App.recipe=new App.Models.Recipe({id:a}),App.recipeView=new App.Views.Recipe({model:App.recipe}),$(".main").html(App.recipeView.el),App.recipeView.render()},add:function(){$.get("http://local.madlibrobots.com/?q=node/add/mad-lib&ajax=1",function(a){$(".main").html(a)})}})}();